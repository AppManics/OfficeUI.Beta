var OfficeUIRibbon=angular.module("OfficeUIRibbon");OfficeUIRibbon.controller("OfficeUIRibbon",["$scope","$http","$animate",function(b,e,d){var a={Hidden:1,Visible:2,Showed:3};var c=this;c.state=a.Showed;e.get("/OfficeUI.Beta/Resources/Data/ribbon.json").success(function(g){c.Tabs=g.Tabs;var f=c.Tabs[0].MenuItems[0];b.setApplicationMenuItemAsActive(f);c.activeTab=g.Tabs[1].Id;c.applicationMenuActive=false}).error(function(f){console.error("An error occured while loading the data file.")});b.setApplicationMenuItemAsActive=function(f){c.setApplicationMenuItemAsActive(f)};c.setApplicationMenuItemAsActive=function(f){if(f.Seperator!="True"){c.activeApplicationMenuItem=f}};c.isApplicationMenuActive=function(f){return c.activeApplicationMenuItem==f};c.setApplicationMenuAsOpened=function(){c.applicationMenuActive=true};c.setApplicationMenuAsClosed=function(){c.applicationMenuActive=false};c.isApplicationMenuOpened=function(){return c.applicationMenuActive};c.isActive=function(f){return this.activeTab==f};c.setActiveTab=function(f){c.activeTab=f;if(c.state==a.Hidden){c.state=a.Visible}};c.setActiveTabOnHover=function(f){if($.fn.OfficeUI.Defaults.changeActiveTabOnHover){c.activeTab=f;if(c.state==a.Hidden){c.state=a.Visible}}};c.isHidden=function(){return c.state==a.Hidden};c.isVisible=function(){return c.state==a.Visible};c.isShowed=function(){return c.state==a.Showed};c.toggleRibbonState=function(){if(c.state==a.Showed){c.state=a.Hidden}else{if(c.state==a.Visible){c.state=a.Showed}}};b.setActiveTab=function(f){c.setActiveTab(f);b.$apply()};b.setRibbonHidden=function(){c.state=a.Hidden;b.$apply()};b.setRibbonVisisble=function(){c.state=a.Visible;b.$apply()};b.setRibbonShowed=function(){c.state=a.Showed;b.$apply()};b.isHidden=function(){return c.isHidden()};b.isVisible=function(){return c.isVisible()};b.isShowed=function(){return c.isShowed()};b.ribbonScroll=function(f){if(f.detail>0||f.wheelDelta<0){if($("li[role=tab].active").next().attr("id")!=null){c.setActiveTab($("li[role=tab].active").next().attr("id"))}}else{if($("li[role=tab].active").prev().not(".application").attr("id")!=null){c.setActiveTab($("li[role=tab].active").prev().attr("id"))}}b.$apply()};$(window).on("click",function(f){if(c.state==a.Visible){b.setRibbonHidden()}});$("#ribbonContents").on("click",function(f){f.stopPropagation()})}]);