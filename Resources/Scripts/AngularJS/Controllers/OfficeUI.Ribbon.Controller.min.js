var OfficeUIRibbon=angular.module("OfficeUIRibbon");OfficeUIRibbon.controller("OfficeUIRibbon",["$scope","$http","OfficeUIRibbonService",function(a,c,b){a.OfficeUIRibbon.ribbonStates={};a.OfficeUIRibbon.initialized=false;a.isRibbonInitialized=function(){return a.OfficeUIRibbon.initialized};c.get($.fn.OfficeUI.ribbonDataFile).success(function(e){b.setServiceInstance(e);a.OfficeUIRibbon=b.getServiceInstance();var d=e.Tabs[0].MenuItems[0];a.setApplicationMenuItemAsActive(d)}).error(function(d){console.error("An error occured while loading the file '"+$.fn.OfficeUI.ribbonDataFile+"' file. ")});a.setActiveTabOnScrolling=function(d){if($.fn.OfficeUI.Defaults.changeActiveTabOnHover){b.setActive(d)}};a.isRibbonShowed=function(){return a.OfficeUIRibbon.state==a.OfficeUIRibbon.ribbonStates.Showed};a.isRibbonVisible=function(){return a.OfficeUIRibbon.state==a.OfficeUIRibbon.ribbonStates.Visible};a.isRibbonHidden=function(){return a.OfficeUIRibbon.state==a.OfficeUIRibbon.ribbonStates.Hidden};a.toggleRibbonState=function(){if(a.OfficeUIRibbon.state==a.OfficeUIRibbon.ribbonStates.Showed){a.OfficeUIRibbon.state=a.OfficeUIRibbon.ribbonStates.Hidden}else{if(a.OfficeUIRibbon.state==a.OfficeUIRibbon.ribbonStates.Visible){a.OfficeUIRibbon.state=a.OfficeUIRibbon.ribbonStates.Showed}}};a.contextualGroupHasAnActiveTab=function(e){if(a.OfficeUIRibbon.activeContextualGroups.length==0){return false}else{var d=$.grep(e.Tabs,function(f){return f.Id==a.OfficeUIRibbon.activeTab});return d.length>0}};a.ribbonScroll=function(e){var f=null;if(e.detail>0||e.wheelDelta<0){var d=$(".ribbon .active");if(d.next().attr("id")!=null){f=d.next()}else{if(d.parents(".context-group").length==0){if($(".active-contextual-group").length>0){f=$(".tab",".active-contextual-group")}}else{if(d.parents(".active-contextual-group").next(".active-contextual-group").length>0){f=$(".tab",d.parents(".active-contextual-group").next(".active-contextual-group"))}}}}else{var d=$(".ribbon .active");if(d.prev().attr("id")!=null&&!d.prev().hasClass("application")){f=d.prev()}else{if(!d.prev().hasClass("application")){if(d.parents(".context-group").length==0){if($(".active-contextual-group").length>0){f=$(".tab",".active-contextual-group")}}else{if(d.parents(".active-contextual-group").prev(".active-contextual-group").length>0){f=$(".tab",d.parents(".active-contextual-group").prev(".active-contextual-group")).last()}else{f=$(".ribbon .tab-normal").last()}}}}}if(f!=null){a.setActive(f.attr("id"))}a.$apply()};a.isApplicationMenuItemActive=function(d){return a.activeApplicationMenuItem==d};a.setApplicationMenuItemAsActive=function(d){if(d.Seperator!="True"){a.activeApplicationMenuItem=d}};$(window).on("click",function(d){if(a.OfficeUIRibbon.state==a.OfficeUIRibbon.ribbonStates.Visible){a.OfficeUIRibbon.initialized=true;a.OfficeUIRibbon.state=a.OfficeUIRibbon.ribbonStates.Hidden;a.$apply()}})}]);