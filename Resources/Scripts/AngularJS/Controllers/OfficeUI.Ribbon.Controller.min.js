var OfficeUIRibbon=angular.module("OfficeUIRibbon");OfficeUIRibbon.controller("OfficeUIRibbon",["$scope","$http","OfficeUIRibbonService",function(a,c,b){a.OfficeUIRibbon.ribbonStates={};c.get($.fn.OfficeUI.ribbonDataFile).success(function(d){b.setServiceInstance(d);a.OfficeUIRibbon=b.getServiceInstance()}).error(function(d){console.error("An error occured while loading the file '"+$.fn.OfficeUI.ribbonDataFile+"' file. ")});a.isRibbonShowed=function(){return a.OfficeUIRibbon.state==a.OfficeUIRibbon.ribbonStates.Showed};a.isRibbonVisible=function(){return a.OfficeUIRibbon.state==a.OfficeUIRibbon.ribbonStates.Visible};a.isRibbonHidden=function(){return a.OfficeUIRibbon.state==a.OfficeUIRibbon.ribbonStates.Hidden};a.toggleRibbonState=function(){if(a.OfficeUIRibbon.state==a.OfficeUIRibbon.ribbonStates.Showed){a.OfficeUIRibbon.state=a.OfficeUIRibbon.ribbonStates.Hidden}else{if(a.OfficeUIRibbon.state==a.OfficeUIRibbon.ribbonStates.Visible){a.OfficeUIRibbon.state=a.OfficeUIRibbon.ribbonStates.Showed}}};a.contextualGroupHasAnActiveTab=function(e){if(a.OfficeUIRibbon.activeContextualGroups.length==0){return false}else{var d=$.grep(e.Tabs,function(f){return f.Id==a.OfficeUIRibbon.activeTab});return d.length>0}};a.ribbonScroll=function(e){var g=null;if(e.detail>0||e.wheelDelta<0){var d=$(".ribbon .active");if(d.next().attr("id")!=null){g=d.next()}else{if(d.parents(".context-group").length==0){if($(".active-contextual-group").length>0){g=$(".tab",".active-contextual-group")}}else{if(d.parents(".active-contextual-group").next(".active-contextual-group").length>0){g=$(".tab",d.parents(".active-contextual-group").next(".active-contextual-group"))}}}if(g!=null){a.setActive(g.attr("id"))}}else{var f=$(".ribbon .active").prev();if(f.attr("id")!=null&&!f.hasClass("application")){a.setActive(f.attr("id"))}}a.$apply()};$(window).on("click",function(d){if(a.OfficeUIRibbon.state==a.OfficeUIRibbon.ribbonStates.Visible){a.OfficeUIRibbon.state=a.OfficeUIRibbon.ribbonStates.Hidden;a.$apply()}})}]);