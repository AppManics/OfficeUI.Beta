var OfficeUIRibbon=angular.module("OfficeUIRibbon");OfficeUIRibbon.controller("OfficeUIRibbon",["$scope","$http","$animate",function(f,h,i){var j=this;var g={Hidden:1,Visible:2,Showed:3};j.state=g.Showed;h.get($.fn.OfficeUI.ribbonDataFile).success(function(a){j.Tabs=a.Tabs;j.ContextualGroups=a.ContextualGroups;var b=j.Tabs[0].MenuItems[0];f.setApplicationMenuItemAsActive(b);j.activeTab=a.Tabs[1].Id}).error(function(a){console.error("An error occured while loading the data file.")});f.setApplicationMenuItemAsActive=function(a){if(a.Seperator!="True"){j.activeApplicationMenuItem=a}};j.toggleApplicationMenu=function(){if(!j.applicationMenuActive){j.applicationMenuActive=true}else{j.applicationMenuActive=false}};j.isApplicationMenuItemActive=function(a){return j.activeApplicationMenuItem==a};j.isApplicationMenuOpened=function(){return j.applicationMenuActive};j.isTabActive=function(a){return this.activeTab==a};j.setActiveTab=function(b,a){if(!a){if(j.state==g.Hidden){j.state=g.Visible}j.activeTab=b}else{if($.fn.OfficeUI.Defaults.changeActiveTabOnHover){if(j.state==g.Hidden){j.state=g.Visible}j.activeTab=b}}};j.isHidden=function(){return j.state==g.Hidden};j.isVisible=function(){return j.state==g.Visible};j.isShowed=function(){return j.state==g.Showed};j.toggleRibbonState=function(){if(j.state==g.Showed){j.state=g.Hidden}else{if(j.state==g.Visible){j.state=g.Showed}}};f.setRibbonHidden=function(){j.state=g.Hidden;f.$apply()};f.setRibbonShowed=function(){j.state=g.Showed;f.$apply()};f.ribbonScroll=function(a){if(a.detail>0||a.wheelDelta<0){if($("li[role=tab].active").next().attr("id")!=null){j.setActiveTab($("li[role=tab].active").next().attr("id"))}}else{if($("li[role=tab].active").prev().not(".application").attr("id")!=null){j.setActiveTab($("li[role=tab].active").prev().attr("id"))}}f.$apply()};$(window).on("click",function(a){if(j.state==g.Visible){f.setRibbonHidden()}});$("#ribbonContents").on("click",function(a){a.stopPropagation()})}]);